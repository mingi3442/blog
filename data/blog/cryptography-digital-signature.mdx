---
title: '[Cryptography] Digital Signature and RSA, ECC'
date: '2022-05-13'
lastmod: '2022-05-13'
tags: ['Cryptography', 'Digital-Signature', 'RSA', 'ECC']
draft: false
summary: 'ì „ì ë¬¸ì„œì˜ ë°ì´í„° ë¬´ê²°ì„±ê³¼ ì¶œì²˜ ì¦ëª…ì„ ìœ„í•œ ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì¸ Digital Signatureì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤. ğŸ¤”'
images: ['/static/images/cryptography.png']
---

<TOCInline toc={props.toc} exclude="Introduction" />

## Digital Signature

**ì „ì ë¬¸ì„œì˜ ë°ì´í„° ë¬´ê²°ì„±ê³¼ ì¶œì²˜ ì¦ëª…ì„ ìœ„í•œ ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜**

### ì „ì ì„œëª… & ì¼ë°˜ ì„œëª…ì˜ ì°¨ì´ì 

|   â€‡â€‡â€‡    | ì¼ë°˜ ì„œëª…                                 | ì „ì ì„œëª…                                                                        |
| :------: | ----------------------------------------- | -------------------------------------------------------------------------------- |
| **íŠ¹ì§•** | ë¬¸ì„œì— í¬í•¨í•œë‹¤ (ë‚±ì¸, ì„œëª… ë“±..)         | ë¬¸ì„œì™€ ì„œëª…ì´ ë¶„ë¦¬ëœ íŒŒì¼ë¡œ ì¡´ì¬                                                 |
| **ê´€ê³„** | 1:n ê´€ê³„                                  | 1:1 ê´€ê³„                                                                         |
| **ë³µì œ** | ì„œëª…ëœ ë¬¸ì„œì˜ ë³µì‚¬ë³¸ê³¼ ì›ë³¸ì€ êµ¬ë¶„ì´ ê°€ëŠ¥ | ì›ë³¸ê³¼ ë³µì‚¬ëœ ë¬¸ì„œë¥¼ êµ¬ë¶„í•  ìˆ˜ ì—†ìœ¼ë©° êµ¬ë¶„í•´ì•¼í•˜ëŠ” ê²½ìš° ë¬¸ì„œì— íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì¶”ê°€ |

### ì „ìì„œëª… íŠ¹ì§•

- **Message Authentication** (ì¸ì¦)

  âœ“ _ë°œì‹ ìì˜ ê³µê°œí‚¤ë¥¼ í†µí•´ ê²€ì¦ë˜ë¯€ë¡œ ë°œì‹ ìê°€ ë³´ë‚¸ ê²ƒì„ ì¸ì¦ ê°€ëŠ¥í•©ë‹ˆë‹¤._

- **Message Integrity**â€‡(ë¬´ê²°ì„±)

  âœ“ _ë©”ì„¸ì§€ê°€ ìˆ˜ì •ë  ê²½ìš° ì„œëª…ì´ ë³€ê²½ë˜ê¸° ë•Œë¬¸ì— ë¬´ê²°ì„±ì´ ê²€ì¦ë©ë‹ˆë‹¤._

- **Nonrepudiation**â€‡(ë¶€ì¸ ë°©ì§€)

  âœ“ _ì‹ ë¢°ê°€ëŠ¥í•œ ì œ 3ìë¥¼ ìˆë‹¤ë©´ ë°œì‹ ìê°€ ë³´ë‚¸ ë©”ì„¸ì§€ë¥¼ ë°œì‹ ìê°€ ë³´ë‚´ì§€ ì•Šì•˜ë‹¤ê³  ì£¼ì¥í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤._

> ğ–¤ **_ì „ìì„œëª…ì€ ê¸°ë°€ì„±ìœ ì§€ë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤._**
>
>     â¤· **_Plain Textë¥¼ ì´ìš©í•˜ì—¬ ì„œëª…í•  ê²½ìš°ì—ëŠ” ê²€ì¦ê³¼ì •ì—ì„œ PlainTextê°€ ê·¸ëŒ€ë¡œ ë…¸ì¶œ ë  ìˆ˜ ìˆìœ¼ë©°, ì´ì™€ ê°™ì€ ì´ìœ ì™€ ë¹„ëŒ€ì¹­ í‚¤ ì•”í˜¸í™”ì˜ íŠ¹ì§•ì„ ê³ ë ¤í•´ PlainTextë¥¼ í•´ì‹±í•˜ì—¬ Digestë¡œ ë§Œë“  í›„ ì„œëª…í•©ë‹ˆë‹¤_**

---

## RSA ë””ì§€í„¸ ì„œëª…

âœ“ _**RSA ì•Œê³ ë¦¬ì¦˜**ì€ ì•”í˜¸í™”ì— ìˆ˜ì‹ ìì˜ ê³µê°œ í‚¤ì™€ ë³µí˜¸í™”ì— ìˆ˜ì‹ ìì˜ ê°œì¸ í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°˜ë©´, **RSA ë””ì§€í„¸ ì„œëª…**ì€ ë°œì‹ ìì˜ ê°œì¸ í‚¤ë¡œ ì„œëª…ì„ ìƒì„±í•˜ê³  ë°œì‹ ìì˜ ê³µê°œ í‚¤ë¡œ ê·¸ê²ƒì„ ê²€ì¦í•©ë‹ˆë‹¤._

### í‚¤ ìƒì„±ë°©ë²• ğŸ”‘

**âœ“ _í‚¤ ìƒì„±ë°©ë²•ì€ ì „ì— ì •ë¦¬í•œ[RSA ì•Œê³ ë¦¬ì¦˜](https://min71.dev/blog/cryptography-asymmetric-key#rsa-%ED%82%A4-%EC%83%9D%EC%84%B1%EA%B3%BC-%EB%B3%B5%ED%98%B8%ED%99%94-%EA%B3%BC%EC%A0%95)ì˜ í‚¤ ìƒì„±ë°©ë²•ê³¼ ë™ì¼í•©ë‹ˆë‹¤!_ ğŸ˜**

### ê²€ì¦ ğŸ§

**_ê²€ì¦ë¶€ë¶„ ì—­ì‹œ [RSA ê²€ì¦](https://min71.dev/blog/cryptography-asymmetric-key#rsa-%EC%A0%95%ED%99%95%EC%84%B1-%EC%A6%9D%EB%AA%85%EA%B3%BC-%EC%98%88%EC%8B%9C) ë¶€ë¶„ê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤._**ğŸ¥²

> $S$ : Signature
> $M$ : Message

- $S = M^d mod n$
- $S^e = (M^eâ€ˆ modâ€ˆ n)^d = M^{ed}â€ˆ modâ€ˆ n$
- $ed = k Ã— Ï†â’© + 1$
- $S^e = M^{ed}â€ˆ modâ€ˆ n= M^{k Ã— Ï†â’© + 1}â€ˆ modâ€ˆ n$
- $S^e = M^{k Ã— Ï†â’© + 1}â€ˆ modâ€ˆ n = Mâ€ˆ modâ€ˆ n$

  â¤· ğ–¤ [Ï†â’© ì˜¤ì¼ëŸ¬ì˜ ì •ë¦¬](https://min71.dev/blog/cryptography-mathematics-in-cryptography#eulers-theorem) ë§ˆì§€ë§‰ ë¶€ë¶„ ğŸ˜‰

---

## ECDSA (íƒ€ì›ê³¡ì„  ë””ì§€í„¸ ì„œëª… êµ¬ì¡°)

### í‚¤ ìƒì„± ë°©ë²• ğŸ”‘

>

1. íƒ€ì› ê³¡ì„  $E_p (a,b)$ ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

   â¤· **_$p$ëŠ” prime Number,ì†Œìˆ˜ì…ë‹ˆë‹¤._**

   â¤· $Y^2 mod p = (x^3 + ax + b) mod p$

2. ë‹¤ë¥¸ ì†Œìˆ˜ $q$ì™€ ê°œì¸ í‚¤ë¡œ ì‚¬ìš©í•  ì •ìˆ˜ $d$ ì„ íƒí•©ë‹ˆë‹¤.

3. íƒ€ì› ê³¡ì„  ìƒ í•œ ì  $e_1$ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

   â¤· _ì´ ì ì„ generatorë¼ê³ ë„ í•©ë‹ˆë‹¤._

4. ì„ íƒí•œ $e_1$ì™€ ê°œì¸ í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ” ì •ìˆ˜ $d$ë¥¼ ì´ìš©í•´ ë‹¤ë¥¸ í•œ ì  $e_2$ë¥¼ ê³„ì‚° í•©ë‹ˆë‹¤.

   â¤· **$e_2(...â€†,â€†...) = dÃ—e_1(...â€†,â€†...)$**

5. ê°œì¸í‚¤ëŠ” ì„ íƒí•œ ì •ìˆ˜ $d$ê°€ ë˜ê³ , ê³µê°œí‚¤ëŠ” $e_2$ê°€ ë©ë‹ˆë‹¤.

   â¤· **_ê·¸ëŸ¬ë‚˜ ê³µê°œëœ ê°’ì´ $a, b, p, q, e_1, e_2$ì´ê¸° ë•Œë¬¸ì— ëª¨ë‘ ê³µê°œí‚¤ë¼ê³  ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤._**

### ê²€ì¦ ğŸ§

**âœ“ Sign**

> **_Temporary Private Key_** : $r$
>
>     â¤· **_1 < $r$ < $q$ -1_**
>
> **_Temporary Public Key_** : $P(u,v) = rÃ—e_1(...â€†,â€†...)$
>
> - $S_1$ : $uâ€ˆ modâ€ˆ q$
> - $S_2$ : $(h(M) + dÃ—S_1) Ã— r^{-1}â€ˆ modâ€ˆ q$
>
>   â¤· âˆ´ Signature : ($S_1$, $S_2$)

**âœ“ Verify**

1. ë¨¼ì € ì•„ë˜ì™€ ê°™ì´ ê°€ì •í•©ë‹ˆë‹¤.

   $A$ = $h(M)Ã—S_2^{-1} mod q$

   $B$ = $S_1Ã—S_2^{-1} mod q$

2. Signí•  ë•Œ $S_2$ë¥¼ ë§Œë“  ì•Œê³ ë¦¬ì¦˜ì„ í†µí•´ $r$ì˜ ê°’ì„ êµ¬í•©ë‹ˆë‹¤.

   $S_2$ : $(h(M) + dÃ—S_1) Ã— r^{-1}â€ˆ modâ€ˆ q$

   â¤· $r$ : $(h(M) + dÃ—S_1) Ã— S_2^{-1}â€ˆ modâ€ˆ q$

3. **_Public Key_**ë¥¼ ì´ìš©í•˜ì—¬ ì‹ì„ ê°„ì†Œí™”í•©ë‹ˆë‹¤.

   â¤· $P(u,v) = rÃ—e_1 = (h(M) + d Ã— S_1) Ã— S_2^{-1}â€ˆ modâ€ˆ q$

   = $(h(M)Ã— S_2^{-1}) + (d Ã— S_1Ã— S_2^{-1})â€ˆ modâ€ˆ q$

   = $AÃ— e_1 + d Ã— B Ã— e_1â€ˆ modâ€ˆ q$

   = $AÃ— e_1 + B Ã— e_2â€ˆ modâ€ˆ q$

4. íƒ€ì› ê³¡ì„  ìƒ ì  $T$ì˜ ì¢Œí‘œë¥¼ ìƒì„±í•©ë‹ˆë‹¤,
   â¤·$T(x, y)$ = $A Ã— e_1 + B Ã— e_2$
5. $S_1 = uâ€ˆ modâ€ˆ q$ ì´ë¯€ë¡œ $S_1 = xâ€ˆ modâ€ˆ q$ ì¼ ê²½ìš° **ê²€ì¦ ì™„ë£Œ!!** ğŸ¥³ ğŸ“
